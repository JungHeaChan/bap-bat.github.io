// parallax
// options.parallax = [0, 1] - offset width*parallax
function ws_glass_parallax(F,E,U){function H(l){return Math.round(1E3*l)/1E3}function Z(l,y,g,d){var G=(parseInt(l.parent().css("z-index"))||0)+1;if(J){G=d.getContext("2d");G.drawImage(l.get(0),0,0,y.width,y.height);var u;a:if(l=d.width,y=d.height,isNaN(g)||1>g)u=void 0;else{g|=0;try{u=G.getImageData(0,0,l,y)}catch(H){console.log("error:unable to access image data: "+H);u=!1;break a}var b=u.data,n,I,a,e,f,S,h,k,m,B,C,D,p,q,r,v,w,x,A;n=g+g+1;var F=l-1,K=y-1,t=g+1,L=t*(t+1)/2,M=new Y,c=M;for(a=1;a<
n;a++)if(c=c.next=new Y,a==t)var E=c;c.next=M;c=a=null;S=f=0;var N=aa[g],O=ba[g];for(I=0;I<y;I++){p=q=r=h=k=m=0;B=t*(v=b[f]);C=t*(w=b[f+1]);D=t*(x=b[f+2]);h+=L*v;k+=L*w;m+=L*x;c=M;for(a=0;a<t;a++)c.r=v,c.g=w,c.b=x,c=c.next;for(a=1;a<t;a++)e=f+((F<a?F:a)<<2),h+=(c.r=v=b[e])*(A=t-a),k+=(c.g=w=b[e+1])*A,m+=(c.b=x=b[e+2])*A,p+=v,q+=w,r+=x,c=c.next;a=M;c=E;for(n=0;n<l;n++)b[f]=h*N>>O,b[f+1]=k*N>>O,b[f+2]=m*N>>O,h-=B,k-=C,m-=D,B-=a.r,C-=a.g,D-=a.b,e=S+((e=n+g+1)<F?e:F)<<2,p+=a.r=b[e],q+=a.g=b[e+1],r+=a.b=
b[e+2],h+=p,k+=q,m+=r,a=a.next,B+=v=c.r,C+=w=c.g,D+=x=c.b,p-=v,q-=w,r-=x,c=c.next,f+=4;S+=l}for(n=0;n<l;n++){q=r=p=k=m=h=0;f=n<<2;B=t*(v=b[f]);C=t*(w=b[f+1]);D=t*(x=b[f+2]);h+=L*v;k+=L*w;m+=L*x;c=M;for(a=0;a<t;a++)c.r=v,c.g=w,c.b=x,c=c.next;e=l;for(a=1;a<=g;a++)f=e+n<<2,h+=(c.r=v=b[f])*(A=t-a),k+=(c.g=w=b[f+1])*A,m+=(c.b=x=b[f+2])*A,p+=v,q+=w,r+=x,c=c.next,a<K&&(e+=l);f=n;a=M;c=E;for(I=0;I<y;I++)e=f<<2,b[e]=h*N>>O,b[e+1]=k*N>>O,b[e+2]=m*N>>O,h-=B,k-=C,m-=D,B-=a.r,C-=a.g,D-=a.b,e=n+((e=I+t)<K?e:K)*
l<<2,h+=p+=a.r=b[e],k+=q+=a.g=b[e+1],m+=r+=a.b=b[e+2],a=a.next,B+=v=c.r,C+=w=c.g,D+=x=c.b,p-=v,q-=w,r-=x,c=c.next,f+=l}G.putImageData(u,0,0);u=!0}return u?z(d):0}d=z("<div></div>").css({position:"absolute","z-index":G,left:0,top:0}).css(y).appendTo(d);u=(Math.sqrt(5)+1)/2;E=1-u/2;for(e=0;E*e<g;e++)b=Math.PI*u*e,K=E*e+1,y=K*Math.cos(b),b=K*Math.sin(b),z(document.createElement("img")).attr("src",l.attr("src")).css({opacity:1/(e/1.8+1),position:"absolute","z-index":G,left:Math.round(y)+"px",top:Math.round(b)+
"px",width:"100%",height:"100%"}).appendTo(d);return d}function Y(){this.a=this.b=this.g=this.r=0;this.next=null}var z=jQuery,ca=z(this),V=F.parallax||.25,Q=z("<div>").css({position:"absolute",display:"none",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}).addClass("ws_effect ws_glass_parallax").appendTo(U),J=!F.noCanvas&&!window.opera&&!!document.createElement("canvas").getContext;if(J)try{document.createElement("canvas").getContext("2d").getImageData(0,0,1,1)}catch(da){J=0}var A=z("<div>").css({position:"absolute",
left:0,top:0,overflow:"hidden",width:"100%",height:"100%",transform:"translate3d(0,0,0)",zIndex:1}).appendTo(Q),W=A.clone().appendTo(Q),R=A.clone().css({width:"20%"}).appendTo(Q),T,X=A.clone().appendTo(Q).css({zIndex:0});this.go=function(l,y,g){var d=z(E.get(y)),d={position:"absolute",width:d.width(),height:d.height(),marginTop:d.css("marginTop"),marginLeft:d.css("marginLeft")};g=g?1:-1;var G=z(E.get(y)).clone().css(d).appendTo(A),u=z(E.get(l)).clone().css(d).appendTo(W),P=z(E.get(l)).clone().css(d).appendTo(R);
-1==g?(R.css({left:"auto",right:0}),P.css({left:"auto",right:0})):(R.css({left:0,right:"auto"}),P.css({left:0,right:"auto"}));var b=1.3*(U.width()||F.width);U.height();var n;J&&(T||(T=z("<canvas>").css({position:"absolute",left:0,top:0}).attr({width:d.width,height:d.height}).appendTo(X)),T.css(d).attr({width:d.width,height:d.height}),n=Z(z(E.get(l)),d,10,T.get(0)));J&&n||(J=0);wowAnimate(function(d){d=z.easing.swing(d);var a=H(g*d*b),e=H(g*(-b+d*b-(1-d)*b*.2)),f=H(g*(1.4*-b+d*(1.4*b+b/1.3))),l=H(-g*
b*V*d),h=H(g*b*V*(1-d)),k=H(-g*b*(V+.2)*d);d=H(g*(.2*-b+d*b*.4));F.support.transform?(A.css("transform","translate3d("+a+"px,0,0)"),G.css("transform","translate3d("+l+"px,0,0)"),W.css("transform","translate3d("+e+"px,0,0)"),u.css("transform","translate3d("+h+"px,0,0)"),R.css("transform","translate3d("+f+"px,0,0)"),P.css("transform","scale(1.6) translate3d("+k+"px,0,0)"),X.css("transform","translate3d("+d+"px,0,0)")):(A.css("left",a),G.css("margin-left",l),W.css("left",e),u.css("margin-left",h),R.css("left",
f),P.css("margin-left",k),X.css("left",d))},0,1,F.duration,function(){Q.hide();G.remove();u.remove();P.remove();ca.trigger("effectEnd")})};var aa=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,
259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,
360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ba=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,
22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]};
// cube_over
// options.direction - left,right,down,up
// use: Modernizr library
// based on: http://alexdunphy.github.io/refineslide/demo.html
// shadow algorithm from : http://tympanus.net/Tutorials/3DShadingWithBoxShadows/
// create .ws_effect
// options.fallback 
// options.staticColor - true not use RGBaster
jQuery.extend(jQuery.easing,{easeInOutBack:function(c,g,h,r,a,k){void 0==k&&(k=1.70158);return 1>(g/=a/2)?r/2*g*g*(((k*=1.525)+1)*g-k)+h:r/2*((g-=2)*g*(((k*=1.525)+1)*g+k)+2)+h}});
function ws_cube_over(c,g,h){function r(c,f){f=f||{};var g=f.exclude||[],d,a=document.createElement("canvas"),b=a.getContext("2d");a.width=c.naturalWidth;a.height=c.naturalHeight;b.drawImage(c,0,0,c.naturalWidth,c.naturalHeight);try{d=b.getImageData(f.x?f.x:0,f.y?f.y:0,f.w?f.w:c.width,f.h?f.h:c.height).data}catch(h){return console.log("error:unable to access image data: "+h),"#ccc"}for(var a=(f.w?f.w:c.width*f.h?f.h:c.height)||d.length,b={},e="",k=[],x="",y=0,n=0;n<a;){k[0]=d[n];k[1]=d[n+1];k[2]=
d[n+2];e=k.join(",");b[e]=e in b?b[e]+1:1;if(-1===g.indexOf(["rgb(",e,")"].join(""))){var l=b[e];l>y&&(x=e,y=l)}n+=4}return["rgb(",x,")"].join("")}var a=jQuery,k=a(this),l=/WOW Slider/g.test(navigator.userAgent),z=a(".ws_list",h),A=c.perspective||/MSIE|Trident/g.test(navigator.userAgent)?1E3:2E3,p={position:"absolute",backgroundSize:"cover",left:0,top:0,width:"100%",height:"100%",backfaceVisibility:"hidden"},q=/AppleWebKit/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),e=a("<div>").css(p).css({transformStyle:"preserve-3d",
perspective:q&&!l?"none":A,zIndex:8});a("<div>").addClass("ws_effect ws_cube_over").css(p).append(e).appendTo(h);if(!c.support.transform&&c.fallback)return new c.fallback(c,g,h);var u;this.go=function(v,f){function B(b,a,d,e){b.parent().css("perspective",A);b.width();b.height();wowAnimate(b,{scale:1,translate:[0,0,q&&!l?d:0]},{scale:.85,translate:[0,0,q&&!l?d:0]},.4*c.duration,"easeInOutBack",function(){wowAnimate(b,{scale:.85,translate:[0,0,q&&!l?d:0]},{scale:1,translate:[0,0,q&&!l?d:0]},.4*c.duration,
c.duration-.8*c.duration,"easeInOutBack",e)});wowAnimate(a.front.item,{rotateY:0,rotateX:0},{rotateY:a.front.rotateY,rotateX:a.front.rotateX},c.duration,"easeInOutBack");wowAnimate(a.back.item,{rotateY:a.back.rotateY,rotateX:a.back.rotateX},{rotateY:0,rotateX:0},c.duration,"easeInOutBack");wowAnimate(a.side.item,{rotateY:a.side.rotateY,rotateX:a.side.rotateX},{rotateY:-a.side.rotateY,rotateX:-a.side.rotateX},c.duration,"easeInOutBack")}var d=a(g[f]),d={width:d.width(),height:d.height(),marginTop:parseFloat(d.css("marginTop")),
marginLeft:parseFloat(d.css("marginLeft"))};if(c.support.transform&&c.support.perspective){u&&u.stop();var m=h.width(),b=h.height(),b={left:[m/2,0,0,180,0,-180],right:[m/2,0,0,-180,0,180],down:[b/2,-b/2,180,0,-180,0],up:[b/2,b/2,-180,0,180,0]}[c.direction||["left","right","down","up"][Math.floor(4*Math.random())]],w=a("<img>").css(d),t=a("<img>").css(d).attr("src",g.get(v).src),m=a("<div>").css({overflow:"hidden",transformOrigin:"50% 50% -"+b[0]+"px"}).css(p).append(w).appendTo(e),d=a("<div>").css({overflow:"hidden",
transformOrigin:"50% 50% -"+b[0]+"px"}).css(p).append(t).appendTo(e),t=a('<div class="ws_cube_side">').css({transformOrigin:"50% 50% -"+b[0]+"px",background:c.staticColor?"":r(t[0],{exclude:["0,0,0","255,255,255"]})}).css(p).appendTo(e);w.on("load",function(){z.hide()});w.attr("src",g.get(f).src).load();e.parent().show();u=new B(e,{front:{item:m,rotateY:b[5],rotateX:b[4]},back:{item:d,rotateY:b[3],rotateX:b[2]},side:{item:t,rotateY:b[3]/2,rotateX:b[2]/2}},-b[0],function(){k.trigger("effectEnd");e.empty().parent().hide();
u=0})}else e.css({position:"absolute",display:"none",zIndex:2,width:"100%",height:"100%"}),e.stop(1,1),b=!!((v-f+1)%g.length)^c.revers?"left":"right",m=a("<div>").css({position:"absolute",left:"0%",right:"auto",top:0,width:"100%",height:"100%"}).css(b,0).append(a(g[f]).clone().css({width:100*d.width/h.width()+"%",height:100*d.height/h.height()+"%",marginLeft:100*d.marginLeft/h.width()+"%"})).appendTo(e),d=a("<div>").css({position:"absolute",left:"100%",right:"auto",top:0,width:"0%",height:"100%"}).append(a(g[v]).clone().css({width:100*
d.width/h.width()+"%",height:100*d.height/h.height()+"%",marginLeft:100*d.marginLeft/h.width()+"%"})).appendTo(e),e.css({left:"auto",right:"auto",top:0}).css(b,0).show(),e.show(),z.hide(),d.animate({width:"100%",left:0},c.duration,"easeInOutExpo",function(){a(this).remove()}),m.animate({width:0},c.duration,"easeInOutExpo",function(){k.trigger("effectEnd");e.empty().hide()})}};
